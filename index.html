<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - FAST NET</title>
<link rel="stylesheet" href="assets/css/style.css">
<style>
/* ===== Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ØµÙØ­Ø© ===== */
body { font-family: "Segoe UI", Tahoma, Arial, sans-serif; background:#f5f5f5; margin:0; padding:0; color:#333; }
header { background:#007bff; color:white; padding:15px; text-align:center; }
header h1 { margin:0; font-size:1.8em; }

/* ===== Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ ===== */
nav ul { 
  list-style:none; 
  padding:0; 
  display:flex; 
  justify-content:center; 
  margin:10px 0 0 0; 
  flex-wrap:wrap; 
}
nav ul li { margin:0 10px; }
nav ul li a {
  color:white; 
  text-decoration:none; 
  padding:12px 25px; 
  border-radius:6px;
  font-size:1.2em; 
  font-weight:600; 
  transition: background 0.3s, opacity 0.3s;
  display:inline-block;
  min-width:110px; 
  text-align:center;
}
nav ul li a[href="index.html"] { background-color: #F1C40F; }
nav ul li a[href="subscribers.html"] { background-color: #7BB661; }
nav ul li a[href="payments.html"] { background-color: #F5A623; }
nav ul li a[href="receipts.html"] { background-color: #9B59B6; }
nav ul li a:hover { opacity: 0.85; }
nav ul li a.active { box-shadow: 0 4px 8px rgba(0,0,0,0.2); }

/* ===== Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ===== */
main { padding:30px 20px; max-width:1200px; margin:auto; }
.dashboard { display:flex; gap:20px; flex-wrap: nowrap; justify-content:center; margin-bottom:30px; }

/* ===== Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ===== */
.card { 
  flex: 1 1 0; /* ÙƒÙ„ Ø¨Ø·Ø§Ù‚Ø© ØªØ£Ø®Ø° Ù†ÙØ³ Ø§Ù„Ù…Ø³Ø§Ø­Ø© */
  min-width: 180px; 
  text-align:center; 
  padding:25px 20px; 
  border-radius:12px; 
  box-shadow:0 4px 10px rgba(0,0,0,0.1); 
  font-weight:600; 
  transition: transform 0.3s, box-shadow 0.3s; 
}
.card:hover { transform: translateY(-3px); box-shadow:0 8px 16px rgba(0,0,0,0.2); }
.card.subscribers { background:#4682B4; color:#fff; border:2px solid #315f7f; }
.card.receipts    { background:#7BB661; color:#fff; border:2px solid #5A8C43; }
.card.revenue     { background:#F5A623; color:#fff; border:2px solid #D4881C; }
.card.totalPrice  { background:#1ABC9C; color:#fff; border:2px solid #16A085; }
.card.remaining   { background:#E67E22; color:#fff; border:2px solid #CA6F1E; }

.card h2 { margin:0 0 10px 0; font-size:2em; color:#ffffff; }
.card p { margin:0; font-size:1em; color:#f0f0f0; }

/* ===== Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø³Ø±ÙŠØ¹Ø© ===== */
.quick-links { text-align:center; margin-top:20px; display:flex; gap:15px; justify-content:center; flex-wrap:wrap; }
.delete-all-btn { background:#e74c3c; color:white; padding:12px 20px; border:none; border-radius:5px; cursor:pointer; font-size:1em; min-width:140px; transition: background 0.3s; }
.delete-all-btn:hover { background:#c0392b; }
.delete-all-btn.secondary { background:#555; }
.delete-all-btn.secondary:hover { background:#333; }

/* ===== ØªØ°ÙŠÙŠÙ„ Ø§Ù„ØµÙØ­Ø© ===== */
footer { text-align:center; padding:15px; background:#f1f1f1; margin-top:30px; font-size:0.9em; color:#888; }

/* ===== ØªØ¬Ø§ÙˆØ¨ Ø§Ù„Ù‡Ø§ØªÙ ===== */
@media (max-width: 768px) {
  .dashboard { flex-direction: column; gap:15px; flex-wrap: wrap; }
  .card { width: 100%; }
  nav ul li a { font-size:1.1em; padding:10px 18px; min-width:90px; }
  .quick-links { flex-direction:column; gap:10px; }
}
</style>
</head>
<body>

<!-- Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø© -->
<script>
if(localStorage.getItem("auth") !== "1"){ location.href = "login.html"; }
</script>

<header>
<h1>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - FAST NET</h1>
<nav>
<ul>
<li><a href="index.html" class="active">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
<li><a href="subscribers.html">Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†</a></li>
<li><a href="payments.html">Ø§Ù„Ø¯ÙØ¹</a></li>
<li><a href="receipts.html">Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª</a></li>
</ul>
</nav>
</header>

<main>
<section class="dashboard">
<div class="card subscribers">
<h2 id="totalSubscribers">0</h2>
<p>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†</p>
</div>
<div class="card receipts">
<h2 id="totalReceipts">0</h2>
<p>Ø¹Ø¯Ø¯ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª</p>
</div>
<div class="card revenue">
<h2 id="totalRevenue">$0.00</h2>
<p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</p>
</div>
<div class="card totalPrice">
<h2 id="totalPrice">$0.00</h2>
<p>Ù…Ø¬Ù…ÙˆØ¹ Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</p>
</div>
<div class="card remaining">
<h2 id="totalRemaining">$0.00</h2>
<p>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</p>
</div>
</section>

<section class="quick-links">
<button id="deleteAllBtn" class="delete-all-btn">Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
<button onclick="logout()" class="delete-all-btn secondary">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
</section>
</main>

<footer>
<p>Â© 2026 FAST NET. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
</footer>

<!-- ğŸ”¥ Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyAolIz4UgOSbV1oe0XTl8a8pVfg7Pnfs1w",
  authDomain: "pos2026-310b7.firebaseapp.com",
  databaseURL: "https://pos2026-310b7-default-rtdb.firebaseio.com",
  projectId: "pos2026-310b7",
  storageBucket: "pos2026-310b7.appspot.com",
  messagingSenderId: "221592625111",
  appId: "1:221592625111:web:81b9704a1fa790bcd0f592"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
window.logout = function(){
  localStorage.removeItem("auth");
  location.href = "login.html";
};

// Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
onValue(ref(db, "subscribers"), snapshot => {
  const data = snapshot.val() || {};
  const subscribers = Object.values(data);
  document.getElementById("totalSubscribers").textContent = subscribers.length;

  let totalRevenue = 0;
  let totalReceipts = 0;
  let totalPrice = 0;
  let totalRemaining = 0;

  subscribers.forEach(sub => {
    const price = Number(sub.price || 0);
    totalPrice += price;

    const payments = Array.isArray(sub.payments) ? sub.payments : [];
    const paid = payments.reduce((sum,p)=>sum+Number(p.amount||0),0);
    totalRevenue += paid;
    totalReceipts += payments.length;
    totalRemaining += price - paid;
  });

  document.getElementById("totalRevenue").textContent = `$${totalRevenue.toFixed(2)}`;
  document.getElementById("totalReceipts").textContent = totalReceipts;
  document.getElementById("totalPrice").textContent = `$${totalPrice.toFixed(2)}`;
  document.getElementById("totalRemaining").textContent = `$${totalRemaining.toFixed(2)}`;
});

// Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
document.getElementById("deleteAllBtn").onclick = () => {
  if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ")){
    remove(ref(db));
    alert("ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
  }
};
</script>

</body>
</html>
